<label>เลขที่จ๊อบ</label>
<input id="jobNo">

<label>รหัสงาน</label>
<input id="jobCode" readonly>

<label>จำนวนที่ต้องผลิต</label>
<input id="planQty" readonly>

<label>ขั้นตอนการทำงาน (WC)</label>
<select id="wc"></select>

<label>Oper</label>
<input id="oper" readonly>

<script>
const GAS_URL = 'https://script.google.com/macros/s/AKfycbwmbRX1bSEJjSisKhYI0lsJULE6Mzt8zjkSb3gZvrIzHrcaTJNydIWH8e-_N0V0FUktCA/exec';

async function fetchJobInfo(jobNo) {
  const res = await fetch(GAS_URL, {
    method: "POST",
    body: new URLSearchParams({ action:"jobInfo", jobNo })
  });
  const data = await res.json();

  if (!data.ok) {
    alert(data.msg);
    return;
  }

  document.getElementById("jobCode").value = data.jobCode;
  document.getElementById("planQty").value = data.planQty;

  const wcSelect = document.getElementById("wc");
  wcSelect.innerHTML = "";
  data.wcList.forEach(wc => {
    const opt = document.createElement("option");
    opt.value = wc;
    opt.textContent = wc;
    wcSelect.appendChild(opt);
  });

  wcSelect.onchange = () => {
    const selectedWC = wcSelect.value;
    document.getElementById("oper").value = data.wcOperMap[selectedWC] || "";
  };
}
</script>
